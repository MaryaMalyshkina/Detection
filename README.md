# Detection
Проект посвящен распознаванию дверных и оконных проемов и определению их координат.

Gradio - приложение для демонстрации результата работы [по ссылке](https://huggingface.co/spaces/DataScienceLover/Doors_windows)



Стек технологий

| Компонент                | Технологии                           |
|--------------------------|--------------------------------------|
| Детекция дверей и окон   | Ultralytics YOLO                     |
| Отрисовка изображений    | OpenCV, NumPy                        |
| Веб-интерфейс            | Gradio                               |
| Исследования             | GoogleColab                          |

Структура проекта:
```
plan_points/

├── best.pt                      # веса обученной модели yolo11n.pt
├── Doors_windows.ipynb          # Google Colab тетрадь с обучением модели
├── example.png                  # Скриншот интерфейса приложения Gradio
├── README.md                    # Документация по проекту
└── gradio.ipynb                 # Google Colab тетрадь для демонстрации работы модели с помощью Gradio
```
Модель была обучена на данных с сайта Roboflow.
Датасет включал в себя 675 размеченных в формате YOLOv11 изображений:

- train set включал 591 изображение (88%),
- val set 56 изображений (8%), 
- test set 28 изображений (4%).

Препроцессинг был проведен средствами платформы Roboflow и включал в себя:

- автоматическую ориентацию данных пикселей (с удалением EXIF-ориентации)
- сжатие до 640×640. 

Для создания 3 вариантов каждого исходного изображения были применены следующие аугментации:
- горизонтальное отражение с вероятностью  50%
- случайное кадрирование (обрезка) от 0 до 20% изображения.

В работе использовалась предобученная модель yolo11n.pt.

Число эпох  для обучения задано 100, параметр patience 10 (если в течение 10 эпох не происходит улучшение метрики, обучение нужно прекратить).

Модель обучилась за 54 эпохи, процесс и результат обучения представлен в Doors_windows.ipynb.

Веса модели сохранены в файле best.pt.

На валидационном наборе данных модель показала хорошие метрики mAP50, но не очень высокие mAP50-95. 
В целом она хорошо находит объекты, но плохо локализует их границы, особенно для окон (bounding boxes слишком большие/маленькие).

Для демонстрации работы модели разработано приложение Gradio на платформе Huggingface.co.

[ссылка на приложение](https://huggingface.co/spaces/DataScienceLover/Doors_windows)

Если приложение не открывается по ссылке, можно запустить его локально в блокноте gradio.ipynb, только при запуске необходимо поместить файл с весами модели best.pt  в сессионное хранилище, поскольку при скачивании его из интернета модель не разворачивается.
